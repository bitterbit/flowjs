<head>
    <script type="text/javascript" src="lib/createjs-2015.05.21.min.js"></script>
    <script type="text/javascript" src="src/flow.js"></script>
    <script type="text/javascript" src="src/flow2.js"></script>
    <script type="text/javascript" src="src/flowitem.js"></script>
    <script type="text/javascript" src="src/flowconnector.js"></script>
    
    <script type="text/javascript" src="src/graph.js"></script>
    
</head>
<body>
    <title>Gurdians of the flow charts</title>
    <h1>Gurdians of the flow charts</h1>
    
    <canvas id="canvas1" width="500" height="300"></canvas>
    <canvas id="canvas2" width="500" height="300"></canvas>
    <canvas id="canvas3" width="500" height="300"></canvas>
    <canvas id="canvas4" width="500" height="300"></canvas>
    
    <script type="text/javascript">
    window.addEventListener("load", func);
    
    function func(){
        console.log("LOADED");
        
        
        // TODO: dont allow overlapping connectors (maybe allow only one hop?)
        g = new DiGraph();
        // g.addPaths([
        //     [1,2,3],
        //     [1,2,4,3],
        //     [1,2,5,3]
        //     //[1,2,6,3]
        // ]);
        g.addPath([1,7,8,9]);
        g.addPath([1,2,3]);
        g.addPath([1,2,4,3]);
        g.addPath([1,2,5,3]);
        g.addPath([5,10]);
        
        new DiFlowChart("canvas1", g).draw();
        
        
        gGraph = new DiGraph();
        gGraph.addPaths([
            [1,2,3,4],
            [5,3,4],
            [13,6,4],
            //[10, 11, 6],
            //[10, 12, 6]
            // [7,4,9]
        ]);
        new DiFlowChart("canvas2", gGraph).draw();
        
        
        
        
        //df = new flowjs("canvas4", d);
        //df.draw();
        
        // for(var i=0;i<d.length; i++){
        //     var row = d[i];
        //     for(var k=0; k<row.length; k++){
        //         var item = row[k];
        //         var dur = Math.random() * 1000 * 10;
        //         simulateLoading(item.id, dur);
        //         simulateDoneLoading(item.id, dur*2);
        //     }
        // }
        
        function simulateLoading(itemId, timeout){
            setTimeout(function(){
                df.updateItem(itemId, function(item){
                    item.flowItem.toggleFlashing();
                });
            }, timeout);
            
        }
        
        function simulateDoneLoading(itemId, timeout){
            setTimeout(function(){
                df.updateItem(itemId, function(item){
                    item.flowItem.toggleFlashing();
                    item.flowItem.color = "red";
                    if (item.connectors === undefined){return}
                    item.connectors.forEach(function(conn){
                       conn.color = "red"; 
                    });
                });
            }, timeout);
        }
    
    }
        
    </script>

</body>

